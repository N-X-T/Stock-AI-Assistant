// import { config } from 'dotenv'
// config();

import { getNewsEndpoint, getMistralApiKey } from '../config'
import { ChatMistralAI } from "@langchain/mistralai";
import db from '../db';
import { sectorInfo } from '../db/schema';

const industry = [
    {
        "industryCode": "0500",
        "industryLevel": "2",
        "higherLevelCode": "0001",
        "englishName": "Oil & Gas",
        "vietnameseName": "Dầu khí",
        "totalCount": 27,
        "codeList": "BSR,MTS,PVD,PVY,POV,PCN,PVC,PLX,OIL,PND,PVS,POS,POB,PAT,PVB,PVO,PPY,PTV,PTX,PEQ,PSN,TDG,DMS,PLE,PCG,TLP,PSH",
        "taxCodeList": "t0305795054,t0102631910,t3700146458,t0600393680,t5700100707,t3500806844,t0100108102,t5300656602,t3500850392 ,t0100150873,t0100150577,t4400114094,t0103100084,t3000413193,t0600759399,t3500818790,t4300378569,t0100107370,t6300177249,t0302495126,t1000808141,t0102349865,t2900428497,t2400345718,t2801448559,t0305447723,t0101466968"
    },
    {
        "industryCode": "1300",
        "industryLevel": "2",
        "higherLevelCode": "1000",
        "englishName": "Chemicals",
        "vietnameseName": "Hóa chất",
        "totalCount": 60,
        "codeList": "HAI,TRC,PLC,HSI,HVT,VAF,CNC,CSV,DPD,CPC,PSW,ADS,SIV,HPH,SBR,AVG,APP,SFG,RTB,DGL,PGN,DCI,NHH,VPS,BRC,LAS,PSE,SVG,BRR,BFC,LTG,VFG,NFC,DGC,PCE,PMB,TDP,DPR,HRC,DPM,SPC,BT1,XPH,DCM,TNC,DTT,HPP,PHR,VNP,ABS,CET,DHB,APH,APC,QBS,DDV,HNP,DRI,GVR,YBM",
        "taxCodeList": "t0101438047,t3800100376,t2600108471,t0200730878,t3400382278,t0301266564,t3500103432,t0303331875,t0200762164,t0300632232,t0101452588,t2700224471,t0100103143,t0102886450,t0302975517,t1000389853,t0300408946,t0801210129,t0108242540/0101463614,t0300430500,t1600192619,t0100100858,t0107919283,t6300230407,t1800457478,t0301150295,t0100738312,t0301446260,t2400395807,t4100733174,t0305918852,t2500287403,t3800100464,t2001012298,t0302327629,t6001271719,t0400101482,t1800722461,t0301242080,t3500100424,t3500657173,t0300422482,t5300299830,t0900264799,t0200827051,t3700147532,t4103003733,t0303165480,t3900242776,t0900255402,t0100100311,t0100101611,t3900242832,t0200456505,t5200824701,t6400052980,t3700480244,t0300381966,t2600108217,t2400120344"
    },
    {
        "industryCode": "1700",
        "industryLevel": "2",
        "higherLevelCode": "1000",
        "englishName": "Basic Resources",
        "vietnameseName": "Tài nguyên",
        "totalCount": 119,
        "codeList": "TDN,KMT,SQC,CAP,KTB,TLH,CMI,DTL,BKC,KSQ,KHD,DPS,KSV,MSR,GVT,MEL,LMC,AFC,HSV,BCA,MZG,HLC,HMC,HAP,HGM,BMJ,KSA,ACM,ATG,VGL,VIM,LNC,CST,AAH,SMC,THT,TKU,MCV,MIM,POM,PTK,DTN,BAM,TND,TVN,VCE,TMB,VIF,GLC,HHP,VDB,FRM,BKG,DRG,HPG,VIS,HSG,MIH,CZC,NKG,KLM,ITQ,TQN,MTA,TTS,CKA,VPR,TCS,NBC,BMC,AMC,FCM,NSH,PLP,VPG,HII,TDS,VID,DHM,BGM,KKC,HLA,TVD,FRC,TEG,MTM,PIS,KVC,MC3,VBG,TNB,MDC,TC6,KSC,MIC,KHB,TIS,MMC,DHC,DAP,KSS,DNY,LCM,CHC,CKD,MGC,BCB,CBI,TNI,KSB,DNS,KSH,VGS,VCA,TNS,KCB,MVB,TMG,HUX",
        "taxCodeList": "t5200116441,t0300695842,t0105167260,t3600512830,t0400605391,t0900222647,t4700149122,t3500820408,t4700144572,t0400458027,t0200826844,t4100577172,t5701435907,t6000175829,t3700381282,t0300399360,t3600961762,t1600111049,t0700241917,t4000100139,t0103018538,t0105897161,t2900819613,t5701436805,t2900324603,t2400379403,t0100100544,t0201282851,t4000101407,t2500267703,t3700477019,t0305409326,t3000376142,t0302124121,t3700927878,t0100102580,t2900859599,t6400308865,t0500204315,t0309966889,t5700289449,t0104944595,t5200284005,t3100114609,t0105028958 ,t3700321364,t0200412681,t0305393838,t0303522206,t3600254361,t0400101605,t4800129232,t4600100003,t5700101323,t5400227011,t4200476869,t5700101002,t0101986607,t3700148825,t0800282498,t0100100689,t3300100963,t0300377536,t2600107284,t5700478344,t0106935814,t0900233261,t0104890396,t5700101637,t0102381001,t3600802882,t0102119717,t5700101700,t4100390008,t5700101299,t5700101877,t0102739992,t4600341471,t0100103087,t0800286887,t4200525354,t3701815415,t0100102012,t3700381324,t0400101549,t4600100155,t4800162247,t0100100047,t2500222727,t5700101098,t5700101203,t3000310977,t5701650781,t5200466372,t1300358260,t4000101608,t4100258987,t4103000385,t0900189284,t3600239028,t0100106391,t4600451322,t0101515686,t0700189368,t0103003517,t0101971512,t0100511368,t0200371361,t0301306457,t2600213532,t4700149595,t353031000005,t5100101762,t5300208618,t0700252549,t5300238161,t0100100015,t5702053837,t0106358846"
    },
    {
        "industryCode": "2300",
        "industryLevel": "2",
        "higherLevelCode": "2000",
        "englishName": "Construction & Materials",
        "vietnameseName": "Xây dựng & Vật liệu",
        "totalCount": 421,
        "codeList": "PTC,TXM,MEC,DHA,HMG,CMC,HPS,PPG,SD5,HBC,SDN,VTA,IJC,TV4,ACC,ACE,TV3,HCI,PVA,PEC,CTA,VC6,VHL,SKS,BCE,VCT,PVX,REM,SEL,QCC,ACS,DID,PHH,HTI,PID,CH5,CEC,LLM,CTX,PDB,MBG,TTL,HID,MCT,VIH,SBV,CEE,HTE,EME,QLD,DTB,HTN,TB8,CGV,TLD,EVG,LIC,CC4,TCK,DXD,KSF,XDC,SCG,BCC,HT1,BTS,ICC,SDT,IME,VNE,CTN,MCO,DNP,DAC,TNM,PTB,L44,B82,V21,VE3,VDT,TL4,QTC,HEC,HU3,VC5,VPC,SD1,ND2,THG,VE8,RCD,L63,KPF,TA9,C4G,VHD,TA6,TS5,SJG,TV6,BHV,DPC,SD4,HAS,VTS,SD9,VC1,SDY,CYC,LM7,VE2,MCL,H11,PSB,JSC,KBT,ADP,NNC,PXA,CTM,ICG,PVV,PTL,STV,SCI,CCH,PXC,PTE,HC3,ING,PVH,LQN,DT4,GTS,PCC,BUD,DPG,HC1,PQN,FBC,BM9,HEJ,CDR,TDI,QNT,GH3,GMA,PCH,HMR,NXT,D17,BT6,CID,SJE,CC1,S55,SD7,SIC,HOM,CNT,DC2,DNC,LCC,L40,SDD,HVX,TSM,SDP,CTV,SD8,V15,VCH,CX8,ICI,BHT,L35,VE1,CCM,VES,BTD,HMS,NAC,CQT,G36,L12,AMS,GND,BOT,CT5,TVH,XDH,ATB,LMI,HFB,HAM,FIC,GAB,DFF,GMH,DVG,UIC,ICN,UDC,DTV,VC2,TTC,SD6,NTP,SC5,XMC,L18,L61,CT3,SDE,LCS,S96,LCG,VCS,SDJ,VC3,VE9,QHD,GMX,SHN,LO5,CI5,L14,VCC,PXS,MCG,DGT,D26,NDX,HLD,CDG,PC1,MST,ROS,BMN,XLV,X18,C12,DCR,TGG,PCM,TS3,MES,TCD,BDC,AGE,VMC,BMP,HLY,S91,SCJ,CDC,SJC,L62,L43,SSM,VC9,LM3,V12,TDC,SDK,KCE,VC7,PHC,SCL,S27,PX1,TBT,MCC,CT6,CVN,HDA,GTH,PTD,MDG,VXB,LHC,HU1,PXT,HTB,HFX,DSG,VMI,HPM,BTU,I10,HCD,APL,NMK,HAN,GDA,TA3,VGV,MIE,SCY,BTN,HUB,C69,GKM,THD,TAB,TSA,VTV,SD3,LBM,NAV,CIC,LGC,TCR,NHC,C92,L10,HUT,VIT,TKC,UDJ,LUT,PXI,C47,SVN,DND,PXM,RCC,V11,VT1,VHH,SDH,DAG,DXV,TNY,VSI,CVT,S12,SJM,CTI,C32,HU4,VCX,VE4,ASD,DCF,VVN,AC4,XMD,TDA,VWS,CLH,NSG,C71,MCI,CCV,X77,S72,CMD,TVA,LG9,TBR,HGW,FSO,HHR,CIP,RLC,TDF,CPW,TLT,DCT,S99,SCC,SDC,SNG,DIC,CTD,SD2,TBX,S74,NHA,ALV,HCC,DC4,BVG,PSG,LIG,TMX,SDB,QNC,YBC,TVG,NSN,GHC,FCN,KHL,VRG,DC1,PEN,CDO,SDX,VLB,L45,TTB,SHG,KDM,VIW,USC,TRT,MVC,CEG,AAV,DTD,BDT,C36,DX2,NO1,BCO,HSP,VW3,RYG",
        "taxCodeList": "t0800281102,t1300108704,t4300368987,t0101850677,t3500102365,t0200371234,t0400101235,t3600259916,t5900320629,t0101413483,t0101412313,t0300911356,t0101116096,t5900305243,t5700100263,t0100107042,t5500296523,t2600106523,t0300421520,t0300393538,t0500227640,t4100258747,t2600106234,t0104798552,t0500555916,t0300766500,t0109684397,t0100104651,t0100769656,t0500383583,t0100598520,t2900324850,t0104895563,t0304200346,t0101058736,t6100102662,t0800819038,t0101218757,t0300584155,t0100106433,t2000492299,t0700100257,t0100779365,t2500302820,t0102274810,t0700501750,t0303240995,t3600248576,t3800100802,t4000378261,t3600459834,t0101099228,t0100104901,t0100106257,t1700572808,t0200155561,t3700785535,t3600255703,t1300403675,t0102141289,t0800376530,t3300529819,t4103002310,t2900325156,t3600475018,t5400213153,t0300398078,t1013777325,t0500313811,t0100686544,t4400135552,t0700117613,t0101426757,t0302979487,t2901276166,t1600669108,t0101311315,t2300317851,t3300101011,t5800000424,t1200526842,t0302156370,t4000364082,t1400101396,t0103983390,t0200140967,t3300101156,t2802404931,t0101023733,t0600446389,t0401333013,t3300101075,t0300566614,t0800064718,t0100105870,t0105787835,t0200119411,t4900270327,t0103930374,t0100106440,t0100105380,t5800001347,t3600687943,t0100100745,t0100385603,t3501459505,t0301475102,t2700224390,t0103015940,t0100109674,t3700805566,t5400103880,t0101043264,t5900189325,t0100979011,t3000335587,t0101643744,t3500794814,t0302066222,t0302095576,t3600451024,t0100106352,t0101338571,t2300101958,t0200352802,t0301464823,t0100105743,t0300378152,t3700364079,t0400447064,t0500276454,t0100105503,t0301725747,t0101446753,t0101612880,t4100259236,t0302365984,t0303357746,t1603000026,t0103467702,t5200216647,t6000442688,t4900219747,t0400347937,t3500101298,t0100105278,t3500614211,t0200509429,t0100106313,t1800506679,t5400232452,t0100687185,t0301446937,t2300100471,t0500478210,t0105207386,t0301442227,t4400135344,t3700926112,t0100105694,t3500833615,t2900576216,t2900559122,t4900102650,t0102174005,t0400100986,t0100105895,t5800391633,t0100845515,t0400374458,t3700358798,t4000362102,t0101311837,t5400101273,t0100105140,t2800233984,t0200155547,t0100104309,t2900329305,t0303146167,t0302310209,t5700101147,t0301446422,t0102287094,t3600256545,t5900288566,t0102073938,t0102340326,t0400620833,t0800282385,t0100105976,t4100431180,t0800940115,t0100106553,t0200157840,t1500342370,t0100104997,t0105167581,t1800544868,t0301986393,t2800947548,t0100103619,t0301443037,t0200786983,t0104598666,t0300475734,t4001205776,t0105558271,t0304941312,t0400474004,t0101715540,t0100103295,t0303245217,t3500832971,t3500834094,t3700413826,t0100106426,t0500445085,t3500707730,t0500444772,t2600104526,t3600692809,t0100105239,t0100123319,t0100104570,t3300101300,t0302158498,t5400240573,t0302879813,t0300482241,t3600254001,t0600264117,t0303580769,t4000390766,t0100105479,t4200580651,t2900324346,t5703000009,t3600869728,t0302536580,t0400577169,t0303171325,t2500222558,t1001045855,t0700324666,t0300402493,t0102133351,t0104008162,t3200040982,t2600116271,t0300812161,t0301900678,t2300882483,t5400253188,t0100947309,t0104228175,t0100105574,t0104285261,t4200237892,t4600359768,t0100103175,t5900951536,t0104518043 ,t0700210210,t0107005554,t3700762464,t0500236902,t0101482060,t3700408992,t0103003459,t2800233448,t0101334087,t0101073692,t0103036843,t0100105045,t5400105091,t5900189364,t0101405355,t2500224026,t3600662561,t2800221072,t0400101450,t6000234922,t3500640966,t0101502599,t2900574674,t5700378910,t5300216753,t0100774247,t3600259352,t0300482393,t0100105077,t3600986703,t0106771556,t4300208207,t4700145463,t4600355393,t0105870459,t2600104283,t0101854047,t0100104919,t0301442322,t0305371707,t0300695916,t0300460907,t0200168673,t0100108180,t0401524441,t0108704763,t2901437166,t3700255880,t0301460120,t0102264629,t0500237920,t5300215527,t0700222689,t0305284081,t3700146225,t0100105454,t0100886857,t0200167782,t3600464464,t5900189357,t0302205973,t2800232620,t0400383300,t3600486108,t0500450173,t0500444444,t0500469512,t1800553319,t2901860050,t0400101820,t2900872462,t0102243403,t0500574676,t0800300443,t0102722910,t0103007196,t0100109441,t3300365310,t2800576533,t4600409377,t0100105020,t0100105292,t0300397028,t0100105493,t0105870441,t1800155910,t0100105599,t0301248798,t0305173790,t2900324272,t0400100545,t0100100368,t0100107123,t0100101379,t0105202998,t1300113091,t0100106338,t0100107557,t0301429113,t4300351623,t1601604590,t0307717044,t0101601945,t3700762471,t3500101308,t0300628797,t0800001612,t0101910492,t0303255529,t5700475745,t3600665643,t5900320611,t3600477135,t5900320001,t0500443916,t0400450691,t0500236821,t4200385474,t3500686978,t1000283494,t2300102253,t0101051096,t0301127673,t0303443233,t0203001434,t4200742214,t2100110200,t0301465263,t0101437741,t0100103520,t0102150565,t0101179547,t0101143879,t3600275107,t0103007859,t0302495140,t0100105782,t0102963747,t0102382580,t4600422240,t3500613828,t0100106183,t0102294285,t0100106384,t0300546537,t0100104972,t0300403987,t3700148529,t2900324868,t0100106190,t0100109561,t0700194008,t0305858385,t0800001972,t3600975839"
    },
    {
        "industryCode": "2700",
        "industryLevel": "2",
        "higherLevelCode": "2000",
        "englishName": "Industrial Goods & Services",
        "vietnameseName": "Hàng hóa và dịch vụ công nghiệp",
        "totalCount": 341,
        "codeList": "STG,SDG,ILC,CTB,VFR,VOS,AME,HMH,STS,SBC,GER,GGG,CLL,DHP,SKG,DOP,SFT,NBS,TOP,VLG,DFC,ISG,VMS,NWT,NTR,NHP,TPS,CDH,SZE,NUE,CE1,SAL,MDA,USD,CAM,CAG,CCT,THU,SIG,UMC,BBH,LPT,GIC,RDP,VNC,PJT,CAV,DVP,SWC,STU,KTT,VNL,SMA,DNL,KSK,CLM,NCT,TTZ,VT8,SGP,RAT,HSA,EMG,RHN,SSU,VLP,QLT,MND,CVH,HLS,DS3,VMT,MTB,SBG,HLO,VNA,VPK,VSP,SFI,VST,PVE,MAS,VQC,SRF,VNT,HTL,TSB,SVI,DL1,PRC,VEE,CK8,CTT,NAS,TEC,CNH,CCR,TRS,SAC,PHN,HLR,HNE,HRT,HHV,MBN,ILB,UDL,DUS,RTH,HEP,TBN,TKA,MA1,HIO,ECO,HTV,TMS,HCT,SPA,VGP,PSC,HBD,PVT,VIN,MAC,VBC,LM8,LCD,MLN,SCS,UEM,MVY,KGU,PHP,BTR,RTS,SRT,QSP,TTV,SGN,PKR,QNP,CQN,MPY,KTU,SON,MQB,CIA,THI,DDG,PNP,DSV,HHN,HTK,NCG,GEE,CGL,HGC,XXX,PMS,MCP,BTC,RAL,DDM,ALP,BXD,VCM,AAA,TJC,PGT,SRB,VTX,SSG,INC,VNF,BHC,TV2,HEM,ITS,CMK,CPI,DAT,HKP,UPC,TVM,CMP,DNR,NBR,UCT,VTM,KIP,HNT,HTR,CCP,NAU,SVL,PRT,QNU,PBT,BLU,DSS,TOT,MHY,BXT,PVM,SHE,CFM,DKC,MDT,VNDFUND,BPC,PAC,MHC,CJC,PJC,SDA,NOS,DXP,VFC,PSP,BXH,WTC,VTP,DVH,SPP,PDN,DZM,HDO,TBD,PAP,PMP,SAS,BCG,BRS,MTL,DBH,IFC,ACV,NNB,QBR,GEX,DLT,CNN,MTV,DAR,VSM,MQN,SUM,TUG,ASG,TOS,PLO,MHP,HGR,HTH,IBN,AIGASIA,SHC,STP,TV1,TPC,DHL,DQC,PTT,VKC,PPS,VKP,VSG,SPI,PBP,ILS,TED,HTU,HAH,NNG,NAP,SLC,PYU,BMD,PDV,VGR,THR,HCS,CVC,IST,PVP,EMS,TCW,CAR,MCD,TR1,DKH,CVP,VXT,SBB,MTX,AIG,VSA,TTP,VIP,PTS,BBS,VTO,SFN,MVN,GMD,SGS,HPL,VSC,BTH,PTH,HPB,PCT,TCO,GLT,MAX,TCL,MTH,TNP,CMS,PPE,HHG,SCO,PTM,ARM,TPP,BTG,EMC,TKRC,CKH,VPA,CDN,DDH,YRC,TVU,MLC,TSG,DNE,VSE,IBD,NEM",
        "taxCodeList": "t0180055452,t2703000092,t0800373586,t0300669828,t0302832526,t1900437757,t0100101298,t0102560459,t0301824508,t0500447942,t0301825452,t0301888974,t0101352858,t0304082452,t1000272301,t0500387891,t0200387594,t0301872364,t0400101676,t0304184415,t0309532497,t3300269568,t0201040588,t4500139769,t0100108913,t0311638525,t3700791715,t0300442760,t0309444635,t3200266161,t0100107934,t0102307343,t0100107772,t0304843611,t1701353245,t0301339815,t0106121967,t4900102530,t0100106169,t1200421913,t0301427028,t0100520683,t0101526991,t3700363445,t0301446863,t0103011186,t0101809894,t0301838116,t0101116000,t0200563063,t0102833561,t5700647458,t0400438101,t0100105937,t0300545501,t3300515171,t0305475110,t0301097524,t0101206286,t0106889438,t1600254777,t2400152522,t2800190392,t0301072382,t0307821849,t5200152471,t0100110052,t4100694020,t3700146539,t0300420157,t0400392263,t0100110415,t1900331334,t3500137706,t6100146571,t4300225555,t6300330070,t2300898204,t0200344784,t5900182111,t2900326054,t0301714946,t4300429492,t0313140100,t0600324084,t0100100417-030,t0107547109,t2300244882,t0300390921,t0800287016,t0301384695,t5700479764,t0300648264,t0102327357,t0200113152,t0302336158,t0100919284,t0400101901,t0600201572,t0102662098,t4200272350,t1400475345,t1600125108,t0301123125,t0200809454,t0310346174,t5700688013,t0101640729,t5700100231,t0100107839,t0101401706,t3600274914,t3000336559,t0800258431,t0311315789,t1500169888,t0600001446,t5800075879,t2100234397,t2500155809,t2900326985,t2600116056,t1000219925,t0106182582,t0300542187,t2800508928,t3700431078,t0100101925,t1600895650,t3500874315,t0100106458,t5100165283,t2500303038,t3600448180,t5700495999,t0100100696,t0200754420,t0302525162,t0100108504,t0303154993,t0301874259,t0200412699,t0200453688,t0200793081,t0300447173,t0100105609,t1700556108,t0102345275,t5700102567,t0100769663,t2900330702,t0200380768,t0312610240,t0201768923,t5700100552,t0400228640,t0104575757,t0200170658,t2001128655,t0106459724,t0500237543,t0200534908,t0106893917,t2700135623,t0107461250,t4400115884,t0600143867,t3200011389,t0301411035,t0200545032,t0302760102,t0200600741,t3600648493,t0700382548,t5700526340,t3702308640,t0106798702,t0100101322,t0300381564,t0100100512,t0310103090,t5700353419,t0100100456,t0109204756,t4103003977,t0302511219,t0200443827,t0301471330,t0301776205,t0301975289,t1000332857,t0100105729,t0400101972,t0400259705,t0106921949,t4200285254,t0400267431,t0100106264,t5700477326,t2900383711,t0100769649,t0102234864,t0500239004,t0500332500,t4200444916,t3500100167,t0301017568,t2500144243,t9988776655,t0302272627,t0303640880,t0106332492,t0304116373,t0100779340,t0200580118,t3600253826,t0100102206,t0101394512,t0200575848,t0300645369,t0400102045,t0302166033,t0200577563,t0100105253,t0300448709,t0300424088,t0200426067,t4200238776,t4100259282,t3700785006,t63003199969,t0103818809,t0400101965,t2600109073,t0400424349,t0301114089,t0300437898,t3601033213,t0100108254,t0104093672,t0400426836,t4100258793,t2801330959,t4000108321,t0100100304,t3100488562,t3400861721,t0201093967,t2200177456,t0301447257,t2600632004,t0600312071,t0311966149,t0300627056,t1700110786,t0800208342,t3900419448,t0300363808,t0100103584,t5200216710,t0900191660,t5700526478,t0304875444,t1800158277,t0100793715,t0302590764,t0200119965,t0200511481,t2900599622,t0301120371,t0304934883,t0101149623,t4703000541,t2900325068,t0101826868,t0300479714,t0313159937,t0201579242,t0100107691,t0200171838,t4100259405,t4200810665,t0102680481,t0301634641,t0301479273,t2900556890,t0900166511,t2800152894,t0300467483,t5700587583,t3500144358,t0300384357,t5303000037,t3700510650,t0500436570,t0301671386,t3700148166,t2900741212,t0314524981,t0100100953,t0300405462,t0200168458,t0100100752,t0400528732,t0303527483,t5900437257,t0305020272,t0200106490,t0301116791,t0301825283,t0302160137,t0302743192,t4103000083,t3600334112,t0400999731,t0305168938,t0200149102,t0200576055,t0200236845,t0300430099,t0311638652,t0305654014,t0100104595,t0200580975,t3100213455,t0104960269,t1801319907,t0102403985,t0107726267,t0800012519,t3300101082,t3702606911,t1800271113,t0100108617,t5300133049,t6000179936,t2300181671,t1800544875-002,t0107952805"
    },
    {
        "industryCode": "3300",
        "industryLevel": "2",
        "higherLevelCode": "3000",
        "englishName": "Automobiles & Parts",
        "vietnameseName": "Ôtô & linh kiện phụ tùng ",
        "totalCount": 11,
        "codeList": "SRC,TMT,HHS,CSM,VVS,VEA,VMA,FT1,DRC,IRC,DAS",
        "taxCodeList": "t3600259017,t0104498100,t0100100625,t0100103866,t0100104563,t4600358468,t0300419930,t0400101531,t0400101669,t0200815578,t5700353722"
    },
    {
        "industryCode": "3500",
        "industryLevel": "2",
        "higherLevelCode": "3000",
        "englishName": "Food & Beverage",
        "vietnameseName": "Thực phẩm & Đồ uống",
        "totalCount": 189,
        "codeList": "CAN,FMC,VDL,VHF,FBT,SAB,FDG,IDI,BHP,SLS,QNS,FCC,VOC,KGM,HSL,SB1,SKN,THP,PCF,VSF,TCJ,TTJ,BSL,GQN,MXC,BAF,NNQ,SCV,SSC,PIT,ANV,BAS,AVF,BAL,NDF,VLC,CLP,VSN,HJC,CTP,MSC,CFV,BMV,HGA,ACL,SPH,CMF,ABT,MPC,THB,AAM,S33,LSS,CFC,VCF,VNH,TFC,CAT,HBH,GTC,KHS,SBL,BCF,NSS,BHG,BLT,SJF,FGL,CNA,HDS,LYF,TT6,VTL,SCD,VNM,NHS,HNM,VKD,VIA,AGD,SST,DMN,AFX,HVA,HNF,SGO,BSP,BTB,C22,BSH,CBS,TAR,TAN,DFS,VTQ,CMM,SCA,AGF,AGM,BHN,MCF,ANT,HAT,VTF,KTS,PRO,NAF,APF,BBM,BSD,KSE,FCS,NSC,SPD,ICF,SAF,CMN,SJ1,LAF,TS4,MSN,HAG,APT,DBC,HAD,GFC,ATA,SNC,SMB,GTN,HKB,HKT,MLS,SEA,HNR,BKH,BSQ,VHI,JOS,SKH,SKV,IDP,CCA,BBC,TAC,SSN,IFS,SGC,HLB,PAN,BHS,KDC,TSC,CAD,VHC,PSL,DBF,DNF,WSB,MCH,HNG,GGS,BQB,SPV,ILA,EPC,QHW,CBC,HAV,CMX,NKD,HHC,HVG,NGC,TH1,BLF,SBT,SEC,SHV,THV,PNG,AGX,MCM,BHK,SEP,KDF,NHV,CPA,MML",
        "taxCodeList": "t0102111943,t0300584564,t0102164984,t5700379618,t4201178921,t1600583588,t1400112623,t2300105790,t2000104323,t0302598530,t1800483319-001,t0105873523,t4103004897,t0301428617,t5500512492,t4800104012,t3200042556,t0800283766,t0200153370,t2600393941,t0100103721,t5700433939,t4201675930,t0101784417,t1300376365,t3600495818,t0302047389,t1400469817,t0301805696,t0200344752,t1200507529,t0301261975,t1600194461,t3001065982,t6300331469,t3100114493,t0107020640,t0102109239,t4200235327,t6000183114,t0105334948,t3100301045,t0500293795,t0600161270,t2000102580,t0400100778,t3600363970,t0303498754,t0300588569,t3900244389,t5900377720,t1100664038,t0100102848,t0310745210,t2900326223,t3600267730,t4100259042,t2900329834,t0104246382,t4001203024,t0500463609,t4200283916,t0101275603,t3600261626,t0100102245,t4300338460,t2600114002,t2004963063,t5900421955,t3500387294,t1600720555,t0302317620,t1600168736,t1800518314,t0303576603,t1400103227,t5900189678,t6000173846,t5800469093,t0100103601,t0400100432,t0302017440,t0107151097,t0304517551,t4300205943,t6300254045,t0302207804,t3600271092,t1400437290,t2000103908,t3602675527,t1700460163,t0101444379,t6100228104,t6000181156,t1800241743,t5500155321,t0600265248,t0300559014,t4600483821,t2000104034,t0300613198,t0300585984,t1700100989,t0309802048,t5500154060,t2001122903,t0101376672,t0102314051,t2900326375,t2900783332,t1900333973,t4201624478,t4201675916,t2000393273,t0101218588,t2200208753,t0302634683,t0101449271,t1300102484,t2800463346,t1800465461,t4200464415,t0100107490,t0303141296,t0400100506,t3200474316,t1600230014,t0302901882,t1700339752,t0107795944,t1400521150,t1800241736,t0100512724,t1400371184,t0100104443,t0304475742,t5900712753,t0311224517,t1800586579,t5800408245,t2800791192,t1500459121,t0200159453,t0500238265,t1000317707,t1900253340,t1800448811,t0100102830,t0302705302,t0301776741,t1600680398,t1600513044,t1600230737,t0100114145,t1800632306,t0105927553,t1400641835,t0105806767,t0302416364,t0304263392,t3600268170,t5900190465,t0104659943,t4100739909,t0100367361,t0311265129,t2900765728,t0200761964,t1200575021,t0400101764,t1100107301,t0303752249,t2100307704,t0303366525,t0100107268,t0300523755,t0300105356,t2000105020,t0312933227,t6000183273,t4001204571,t3600262193,t5400257584,t0301472704,t4300321643,t6000182456"
    },
    {
        "industryCode": "3700",
        "industryLevel": "2",
        "higherLevelCode": "3000",
        "englishName": "Personal & Household Goods",
        "vietnameseName": "Đồ dùng cá nhân và đồ gia dụng",
        "totalCount": 108,
        "codeList": "VBH,YSC,VTB,HSM,X20,HLG,GDT,SHA,STK,TVT,TLI,SAV,NAG,KTL,EVE,DLG,MPT,HRG,NTT,SPB,DM7,HPU,DCG,SVD,NJC,HKC,VEC,LGM,TTF,DCS,SHI,NSP,VGT,HCB,G20,BDG,SHX,AAT,MEG,A32,MDN,PAS,TKG,NPS,VDN,KMR,ASA,HTG,ACG,X26,CLC,NDT,HDM,BBT,FBA,TLG,LIX,NET,VTJ,MKT,HUG,HFS,MSH,HNI,THM,VDG,TNG,GHA,GMC,NST,VTI,MDF,HVC,PPH,HHA,BDF,AG1,VDM,HVH,ATD,GTD,NHT,GTK,HLT,BVN,VGG,PTG,KSD,TTG,SSF,M10,XHC,FTM,MGG,VTZ,CCC,MNB,TCM,GTA,GIL,MHL,TMW,TET,RBC,TDT,BMG,AQN,SGI",
        "taxCodeList": "t5900415863,t0200462650,t2500161922,t3700748131,t0900613295,t0100100618,t0100103351,t3300100628,t0700212810,t3300352720,t0304753615,t0301445210,t2300102398,t0301886832,t0315858232 ,t3600254266,t0302317892,t50047191,t2500395568,t2500217389,t0300391837,t0300396916,t0301446221,t4200237973,t0400100457,t0100100008,t0400709400,t1100414052,t0300481625,t3600642822,t0301449014,t0103002812,t0302018927,t0100101065,t0305132089,t4300346609,t0600328515,t0305020995,t3700403867,t0305173769,t0102737811,t0300398889,t0100100294,t3600506058,t3700769438,t0100109339,t1000400095,t0100101403,t0901051761,t0105651739,t3700560531,t0105284398,t0300694937,t0302181666,t0301225328,t0100100657,t0106796293,t0100101308,t4600941221,t0500578254,t0300715584,t2800222245,t0303185504,t0100776445,t0301464830,t0101402121,t3700530696,t0301444263,t0100100216,t0105283073,t0303207317,t0104606490,t0400410498,t3400353333,t4600305723,t0600019436,t0304484232,t0600986828,t0310710930,t0100108818,t0600333307,t10103402,t0307526635,t0200383737,t0303173361,t0100107927,t4100258761,t0100100826,t0300509782,t0300734844,t0300517896,t0302641539,t0700519785,t3200228141,t0303292182,t3700393217,t0100108127,t0300742387,t0102405830,t0100100939,t2900324811,t0315205307,t0400101556,t4103012492,t0300401524,t0100100375"
    },
    {
        "industryCode": "4500",
        "industryLevel": "2",
        "higherLevelCode": "4000",
        "englishName": "Health Care",
        "vietnameseName": "Y tế",
        "totalCount": 64,
        "codeList": "DVD,JVC,DKP,AMP,DMC,DHT,TTD,DHN,GPC,IMP,AMV,DCL,MEF,VNY,BIO,DAN,TNH,MKP,OPC,SPM,DTH,TW3,TVP,VET,VDP,DHG,DPP,MTP,PMC,NDP,CDP,SOV,DP1,DP2,DDN,DBT,DNM,PBC,DOC,NTF,MRF,DTP,TRA,PPP,MKV,PME,LDP,MED,DP3,CGP,DTG,DBD,DPH,YTC,DVM,DBM,NDC,DHD,BCP,AGP,UPH,HDP,DVN,VXP",
        "taxCodeList": "t3600248086,t0400101404,t0302664945,t3600333736,t4200451832,t2100274872,t0400102077,t0200140269,t0105196582,t0300520465,t0300483319,t1400460395,t4600283621,t4601039023,t1800156801,t3000104879,t0100108536,t1200100557,t0800011018,t4400116704,t4100259564,t1600699279,t0200572501,t1301009978,t1400384433,t0302560110,t0500391400,t0100109385,t0300470246,t0302404048,t0302366480,t0100102326,t0104089394,t0300600417,t0400102101,t5800000047,t1200505472,t0301427564,t0100109113,t0100109032,t3700683163,t2900491298,t0100109191,t0300483037,t0302533156,t0302271207,t1500202535,t0100108656,t0101337659,t0500237656,t0400102091,t0100108430,t3800237998,t0101178800,t2800231948,t0101452595,t1300382591,t0300468511,t0302668322,t0300478598,t6000449389,t3300101406,t0101326329"
    },
    {
        "industryCode": "5300",
        "industryLevel": "2",
        "higherLevelCode": "5000",
        "englishName": "Retail",
        "vietnameseName": "Dịch vụ bán lẻ",
        "totalCount": 60,
        "codeList": "VNB,CRC,CLX,VHE,STH,BTT,HST,BED,CPH,SMN,AST,LMH,BNA,VLF,PNC,KBE,BST,AUM,TIE,CTC,FID,TTH,DGW,HTM,CEN,SED,BDB,BSC,FRT,T12,GCB,NBE,GCF,MJC,SFC,QST,SDV,CTF,CMV,PET,HAX,TMC,CCI,DAD,MWG,KTC,EBS,COM,DST,EFI,AMD,LBC,FHN,TNA,SVC,HTC,PNJ,VMD,HAF,BMF",
        "taxCodeList": "t1500170900,t0105950129,t1100496986,t0300450673,t0900106390,t3600890938,t0105087537,t4100406219,t0300521758,t0300479760,t3602503768,t3503000141,t0302704764,t3400393632,t0306731335,t1700523208,t0107409148,t0400568767,t0311609355,t0302861742,t0107007230,t0101118079,t0100106803,t0301164065,t5900230301,t2000110221,t0300452060,t0400465793,t0301307933,t0302481483,t0101493714,t0301444626,t0102556300,t0305246978,t0104546308,t4600346889,t1700418394,t0301172041,t0600004422,t0301173454,t0100109829,t0307979603,t3600661303,t0100101273,t0309902130,t0100596869,t0100596523,t0311803955,t0312177644,t0301154821,t0304952106,t0102370070,t0100107437,t0201093942,t0107268056,t0300631013,t0302000126,t5700101549,t4400234169,t0104782792"
    },
    {
        "industryCode": "5500",
        "industryLevel": "2",
        "higherLevelCode": "5000",
        "englishName": "Media",
        "vietnameseName": "Phương tiện truyền thông",
        "totalCount": 33,
        "codeList": "SAP,HBE,EID,FOC,DHI,HTP,DAE,ADC,IDN,CAB,LBE,YEG,IN4,HAB,IPH,SGD,INN,HEV,EPH,ADG,SVT,DNB,ODE,STC,ECI,VEF,IKH,FHS,ALT,TPH,PTP,VNX,IHK",
        "taxCodeList": "t0100108007,t0100108014,t0303171300,t0101493707,t0102222393,t0305045911,t0105926285,t0107602021,t0400459486,t0102365521,t0103488607,t0100111472,t0100687474,t0304132047,t0304592171,t1800155452,t0300716891,t4103003297,t0301325347,t1100105921,t0102137109,t0100111754,t0100110302,t0100111659,t0301420079,t3000106354,t0101517669,t0400101517,t0102850165,t0101508664,t0400463362"
    },
    {
        "industryCode": "5700",
        "industryLevel": "2",
        "higherLevelCode": "5000",
        "englishName": "Travel & Leisure",
        "vietnameseName": "Du lịch & Giải trí",
        "totalCount": 45,
        "codeList": "SGH,DXL,WCS,HES,NPH,BSG,KLF,NCS,VJC,RGC,TSD,BCV,VIR,HVN,DAH,CXH,DSP,HOT,VTG,TCT,MTC,HNB,VTR,HGT,DSN,DNT,GTT,STT,FDT,DCD,BLN,RIC,PDC,VTD,VNS,TTR,DLC,ATS,BTV,DSD,TTT,VNG,TSJ,DLD,MNC",
        "taxCodeList": "t0301121128,t1800155131,t0301171827,t3300101124,t4103001723,t0302044758,t4200369786,t3500592920,t0101509403,t0100107155,t0102294528,t4800130044,t0401585934,t0100107282,t0102325399,t4400123162,t3901155981,t0303609986,t3900244068,t0100105528,t0300478044,t2900793002,t0100107518,t0300465937,t2900781381,t0300850255,t1400696545,t0301074118,t0302844200,t5700102119,t4703000307,t4000102418,t0100844825,t4600349907,t4900101456,t3500833679,t0400382219,t3500753423,t6000177738,t0100106017,t0106953041,t0104168889,t0100830798,t0311273634,t3502370391"
    },
    {
        "industryCode": "6500",
        "industryLevel": "2",
        "higherLevelCode": "6000",
        "englishName": "Telecommunications",
        "vietnameseName": "Viễn thông",
        "totalCount": 11,
        "codeList": "VGI,MBFG,PTO,TEL,FOX,NIS,ABC,CTR,VTC,MFS,TTN",
        "taxCodeList": "t0101985025,t0101883619,t0101778163,t0104753865,t0102577251,t0100683141,t0102409426,t3700861497,t0301888195,t0304731322,t0102636299"
    },
    {
        "industryCode": "7500",
        "industryLevel": "2",
        "higherLevelCode": "7000",
        "englishName": "Utilities",
        "vietnameseName": "Dịch vụ tiện ích",
        "totalCount": 152,
        "codeList": "REE,SBA,LKW,S4A,NLS,HPW,BSA,QNW,BGW,NSL,NVP,KTW,VMK,BGE,KHP,NLC,NBW,PGS,RHC,PGD,ISH,NT2,QTP,NCP,GLW,SBM,SBH,DNN,VPW,NDW,TBC,VSH,DTC,HJS,TMP,BTW,NNT,TIC,ASP,EIC,NS2,HND,VPD,TVW,NAW,BNW,NTH,CHS,PDT,LWS,NED,PEG,E12,GE2,DTE,XMP,GDW,PVG,SHP,DRL,QPH,BDW,SP2,VCW,VLW,DNA,SCH,WTN,PGV,BLW,BPW,THN,TNW,PPT,DWC,PJS,GEG,NTW,CHP,THS,TDM,TAP,HPD,TQW,TDB,SVH,LDW,ABR,CMW,EBA,DLM,TBW,BWA,VMG,HFC,DVC,PIC,VCP,THW,LAW,DNW,TAW,DBW,HWS,VAV,HDW,HLE,PBK,BHA,DWS,BHEC,PWS,DTK,HAW,TDW,CLW,PPC,BTP,PGC,BWS,NBP,DNH,GSP,GAS,LCW,GSM,NQT,DVW,POW,HTW,NQN,TTE,BWE,HNA,HBW,KHW,BHWC,STW,PMW,SJD,NQB,MTG,SEB,CNG,EAD,AVC,NBT,CTW,PMG,TOW,NS3,TTA",
        "taxCodeList": "t4200601069,t4100562786,t3801068943,t5200240495,t4200519791,t3500701305,t5900413305,t0102165522,t0104297034,t5700434869,t0108720772,t0100108159,t4103005935,t1100480979,t3500755050,t0200408318,t5400310164,t3900243762,t5600100728,t4400115690,t3400411352,t1900605680,t5100174626,t5700428470,t5100310438,t1600249791,t2802200078,t0102379203,t2900797430,t0102899812,t5300239937,t0102311149,t0304789298,t3500102710,t3600977120,t3700145694,t5400108279,t5000126040,t3100130287,t3500101386,t1400101205,t1400147351,t6100103828,t0303416670,t5300240587,t2800799804,t5500271984,t3502208399,t3000333195,t0305097236,t3600979223,t0305390530,t0100106088,t4300326264,t5900189614,t3600978879,t5300102876,t3702226772,t0400101066,t4000462724,t1300107725,t2400126106,t3800311306,t4000478435,t6101177237,t4300322171,t6000884487,t0102141313,t0303224471,t0304796249,t3000101973,t3800228182,t3600259296,t2000101918,t4600100109,t2800219549,t5700100104,t3300101491,t0600008000,t6300330916,t4100258955,t5300226455,t4100541602,t0300423479,t5800452036,t4400415302,t0313939535,t1800590430,t0101447725,t0304998686,t1100101500,t1800155244,t2500155742,t0321080709,t0800001348,t1801548417,t2500144719,t0400439955,t0800296853,t2700283389,t0200493225,t3100320136,t0400228633,t0314445458,t2800772376,t4200238007,t1500174831,t4900101738,t2100119570,t2300108311,t3600897316,t5700486105,t2900687702,t0400456277,t0101264520,t0400476650,t3800407449,t0102276173,t6000596136,t0304806225,t5800563106,t0304797806,t4500289362,t3500800828,t3200041908,t0200171274,t2900324240,t6000175995,t0101624050,t1100209487,t5500154649,t0310350068,t0300649476,t0300741143,t0201651354,t5900328272,t0400477830,t6101220274,t0400599162,t0200171644,t5900419811,t5900181213,t4700191357,t0304789925,t6200000230,t0310350082,t2200107297,t5800000174,t3500677525"
    },
    {
        "industryCode": "8300",
        "industryLevel": "2",
        "higherLevelCode": "8000",
        "englishName": "Banks",
        "vietnameseName": "Ngân hàng",
        "totalCount": 44,
        "codeList": "ACB,STB,BID,SSB,HDB,MBB,BVB,ABB,PNB,VCB,BAB,PGB,TPB,VRB,OCB,DAB,TB,NAB,MSB,EIB,VAB,TCB,SGB,AGRB,KLB,MXBANK,VNDB,LPB,VIB,EAB,CTG,DCB,NVB,PACB,VBB,VPBF,GB,SCB,WEB,FCB,MHBB,SHB,MDB,VPB",
        "taxCodeList": "t0301179079,t2200269805,t0103012929,t0300608092,t3602983289,t2900325526,t0100233488,t0100150619,t0102744865,t0102360026,t6300048638,t0302963695,t0100233583,t0301378892,t0301452948,t1800278630,t0200253985,t0100230800,t0300852005,t0300610480,t1600169112,t0100111948,t1700197787,t5400104411-007,t0100283873,t0200124891,t0301442379,t0311288990,t0301103908,t1400116233,t1700169765,t0100112437,t0101382193,t0800006089,t0301412222,t0300872315,t0311449990"
    },
    {
        "industryCode": "8500",
        "industryLevel": "2",
        "higherLevelCode": "8000",
        "englishName": "Insurance",
        "vietnameseName": "Bảo hiểm",
        "totalCount": 13,
        "codeList": "PGI,VNR,AIC,PTI,MIG,PVI,BIC,ABI,BMI,BVH,BLI,BHI,PRE",
        "taxCodeList": "t0100774631,t0102385623,t0100110768,t0301458065,t0300446973,t0100931299,t0102737963,t0102183722,t0100111761,t0100151161,t0105434036,t0103085460,t0100110447"
    },
    {
        "industryCode": "8600",
        "industryLevel": "2",
        "higherLevelCode": "8000",
        "englishName": "Real Estate",
        "vietnameseName": "Bất động sản",
        "totalCount": 136,
        "codeList": "NBB,HPR,C21,DIH,NVT,SID,CEO,HD2,CKG,HBI,TN1,VPI,SIP,CRE,HPX,BCM,DXS,UNI,VCG,PVR,STL,TIG,PFL,LGL,FLC,LSG,VGC,DTI,CER,EIN,KOS,AGG,TBH,BIG,RCL,HDC,DXG,NHN,PNT,VNN,LAI,FIR,E29,SJS,CII,ITA,ITC,PPI,D11,VPH,IDV,NDN,IDJ,VNI,CLG,HU6,BAX,HTT,SZC,PLA,SSH,TDH,DIG,NTL,CSC,OCH,SZL,PFV,TNT,SGR,LEC,NTC,NVL,TID,VHM,HRB,IDC,BDP,SZB,KHG,BVL,KHA,LHG,QCG,PDR,SDI,FDC,DTA,HQC,KAC,HAR,TIP,SII,BII,HIZ,SNZ,BCR,ASM,BCI,SDU,OGC,SCR,NTB,CCL,DLR,VCR,NLG,VRE,DCH,PWA,FTI,SZG,TIX,D2D,VIC,KBC,VRC,KDH,DRH,PXL,PVL,CIG,NVN,HDG,FIT,HPI,TCH,LDG,MH3,HD8,NRC,HD3,HD6,PTN,MGR,TAL",
        "taxCodeList": "t0100283802,t0102051941,t0500547376,t0302569547,t0101245486,t0301822194,t0300590663,t0301438936,t0301466299,t0312695565,t3601867699,t0311500196,t0105850244,t0105879162,t0304967631,t0101787915,t0302087938,t0302670307,t0301401291,t0101184201,t0500236860,t0102182140,t0102983609,t0309139261,t0106784499,t3600667859,t3600335363,t0200117929,t0300743380,t0102278484,t0102093571,t0303315400,t0102293517,t0101533886,t0303885305,t0300540937,t0102683813,t0401623121,t1100503295,t0102025250,t0101043105,t0312267721,t0108045831,t0303614496,t0102380872,t0102675516,t0303493756,t5900409387,t0800338870,t0101164614,t3500811001,t2300233993,t0300450962,t3500444601,t0300978657,t0105816010,t0102671977,t0104408749,t0102116074,t0102144120,t0301444753,t0102702590,t0500447004,t0102681319,t0106673358,t4200238430,t0101881347,t0102186593,t3600649539,t0301881016,t0400101323,t3400555146,t3800378251,t0302177966,t0100383878,t0500443384,t0104581743,t0105885166,t0305128163,t0305046979,t3600283394,t3600964611,t0302588596,t0302556594,t2500222004,t0304266964,t3500101523,t0302483177,t0304867926,t0102186917,t0101482984,t0104179545,t2200280598,t3700621209,t0101788806,t3600505336,t0102333784,t3602368420,t0100105616,t1100727545,t0303118498,t0302251673,t3600259560,t0302199864,t0301464904,t1600169024,t4000391600,t0102210969,t0303476454,t0305268812,t0401409093,t0300428854,t1700113586,t0104079036,t0100108173,t0314922132,t5800000142,t0303666737,t0302346036,t0101399461,t3500101107,t0303104343,t1800475847,t0305087904,t0101183550,t0301899038,t0100102446,t3602545493,t0101527970,t3603474037,t0400592801,t0101160306,t0304921066,t3700145020,t3600899948,t0305316946"
    },
    {
        "industryCode": "8700",
        "industryLevel": "2",
        "higherLevelCode": "8000",
        "englishName": "Financial Services",
        "vietnameseName": "Dịch vụ tài chính",
        "totalCount": 172,
        "codeList": "IPA,BVS,CLS,CTS,GBS,VND,NSIC,TVB,VCBS,TCBS,HASC,KVSC,BETA,CMFC,VCBFBCF,VNDAFS0030,FECREDIT,VPBFC_CCTG_16793,IVS,SHS,HVSC,DTDS,DVSC,CASC,VDSE,DSE,TVC,NASC,E1VFVN30,E1SSHN30,PXPVNE,MADC,FUEMAV30,FUEDCMID,FUEVN100,VNDBF,ABW,ORS,PHS,HAFIC,HCM,HAC,AVS,VTSC,VQSC,KBSV,VIETS,VNIS,NVSC,IRSC,TVS,FUCTVGF1,ART,VNHL,VNDAFS003,MBVF,VWFF,FUEKIVFS,FUEIP100,FUEFCV50,PV2,APS,APG,BSI,WSS,AGR,VVF,JSIC,RUBSE,HBSC,ROSE,MKSC,HRSC,TVSI,VFS,CBVS,DDSC,SBBS,HBBS,MHBS,IBC,FUESSV50,EVF,VNDAFS004,VESAF,VNMETF,AAS,TIN,FUCTVGF3,FUEMAVND,VPBFC_CCTG_16884,SSI,PRUBF1,VDS,TCI,DSC,SJCS,AASC,DASC,BMS,KISVN,SASC,ECCS,APSC,VISC,GLSC,TVAM,EVS,VNALLIAN,FUEKIV30,VUA,VNDAFS002,VCFC,VIX,VCI,STSC,VNSC,BIDVF,HFT,FUCTVGF2,MAFEQI,MBVFUND,VIBF,VEOF,FUCTVGF4,QDTCKBV,PIV,KLS,FTS,KEVS,PGSC,ATSC,TSSC,PNSC,MASC,VSEC,MBS,FSC,VCBF,CSI,PYNFUND,VIETENI,FUEVFVND,DCDS,VCAMBF,FUESSVFL,VNDCF,VPBFC_CCTG_17479,VFMVF1,PVF,TAS,SBS,API,HBS,PSI,VIG,HSSC,PCSC,NAVS,MSGS,VSMC,LVSC,VGSC,ACBS,VPBS,VTSS,SDF,FUCVREIT,VNDAF,FUESSV30,ETF,VPBFC_CCTG_15188",
        "taxCodeList": "t0102590252,t0100956399,t0102122617,t0201657860,t0102114648,t0305655145,t0102524651,t0102095561,t0102636115,t0101294902,t0400554813,t3700770190,t0102548959,t0305394278,t0102126675,t0305389969,t0102111132,t0313642887,t0304579068,t0102006610,t0102614143,t0305191655,t0102116349,t0102879157,t1601223161,t0102108468,t0103096046,t0103045147,t0302030508,t0106393583,t0105786768,t0106665886,t0103070866,t0100779693,t59/UBCK-GP,t0102525951,t0102363891,t0102935813,t0102121412,t0102005769,t2900770679,t0102552803,t0102036848,t0102117529,t3500881545,t0102114655,t0305385509,t0105824156,t0302910950,t0102119692,t0304734965,t0102576064,t0102116483,t0102459106,t0101748666,t0102727651,t0101248046,t0102751333,t0102121331,t0305453780,t0304756863,t0312808554,t0101150107,t0101003060,t0305485253,t0102113316,t0305544188,t0304765811,t0103248669,t0103172804,t0311292644,t0305367563,t0102113820,t0305477911,t0102324187,t0106065776,t0102759935,t0103001480,t0102806367,t0102995749-001,t0304814339,t0102659313,t0102636059,t0102355379,t0309312029,t0102124558,t0305970281,t0304769654,t0302941973,t0104979904,t0105530251,t0102311942,t0102766770,t0302991607,t0102065366,t0305055349,t0102306389,t0301955155,t0101057919,t0101078450,t0306081775,t0102088701,t0304763613,t0304407252,t0305066125,t0305299779,t0305351556,t0102973463,t0102669368,t0102171452,t101842669,t0102180545"
    },
    {
        "industryCode": "9500",
        "industryLevel": "2",
        "higherLevelCode": "9000",
        "englishName": "Technology",
        "vietnameseName": "Công nghệ",
        "totalCount": 40,
        "codeList": "LTC,HPT,SGT,VTK,SBD,VHG,KST,ONE,CKV,ONW,VNZ,POT,TLC,ELC,NHW,CMT,VTH,PSD,BEL,HIG,PAI,PIA,SMT,VIE,VLA,SAM,TAG,PMT,VTE,FPT,ST8,TST,SRA,PMJ,TYA,ITD,TGP,VAT,CMG,ICT",
        "taxCodeList": "t0100244112,t0301596604,t0102459018,t0101476469,t0100233174,t0101135243,t0302826473,t0100109106-075,t0101248141,t3600850734,t3600253537,t0108094388,t0500447117,t0101122893,t0306507037,t0305482862,t0100683374,t0800298748,t0102306413,t3600334200,t0301447426,t0800377809,t0302563707,t0103349508,t0303490096,t0100684716,t4000386181,t3600751476,t0300464683,t3600254548,t0101435127,t0303191804,t0101334129,t0100364579,t0101932231,t0302615063,t0101409374,t0100682645,t0101217009,t0100686181"
    }
];

async function get(url) {
    const res = await fetch(url, { headers: { "accept": "*/*", "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36" }, method: "GET", body: null });
    const body = await res.json();
    return body;
}

const post = async (url: string, data: string) => {
    try {
        let res = await fetch(url, { method: "POST", headers: { "accept-language": "vi", 'Content-Type': 'application/json' }, body: data });
        let body = await res.json();
        return body;
    } catch {
        return {};
    }
}

const delay = ms => new Promise(resolve => setTimeout(resolve, ms));

const SectorAnalysis = async () => {
    try {
        const industrychange = await get("https://mkw-socket-v2.vndirect.com.vn/mkwsocketv2/industrychange");
        const industrymap = await get("https://mkw-socket-v2.vndirect.com.vn/mkwsocketv2/industrymap");

        const llm = new ChatMistralAI(
            {
                model: 'mistral-large-latest',
                apiKey: getMistralApiKey(),
                temperature: 0,
                topP: 1
            }
        );


        for (let i = 0; i < industry.length; i++) {
            try {
                let industrychangeRaw = industrychange.data.find(e => e.indexCode == industry[i].industryCode);

                industrychangeRaw = JSON.stringify(industrychangeRaw).replaceAll('indChgCr', 'industry_Change_Cumulative_Return').replaceAll('indChgPctCr', 'industry_Change_Percent_Cumulative_Return');

                const data = {
                    "query": industry[i].vietnameseName,
                    "top_k": 15,
                    "filter": {
                        "date": new Date().toISOString().substring(0, 10)
                    }
                };
                const news = await post(getNewsEndpoint()!, JSON.stringify(data));
                const newsContext = news.map(doc => `Nguồn ${doc.metadata.source}: ${doc.page_content}`).join("\n\n");

                const prompt = `Bạn đóng vai là một nhà phân tích tài chính giàu kinh nghiệm. Hãy đưa ra tóm tắt tình hình ngành ${industry[i].vietnameseName} tại thị trường chứng khoán Việt Nam và đưa ra lời khuyên/nhận xét. Dưới đây là các chỉ số và tin tức về ngành ${industry[i].vietnameseName} tại thị trường chứng khoán Việt Nam ngày ${new Date().toISOString().substring(0, 10)}:\n\n${industrychangeRaw}\n\n${newsContext}`

                const result = await llm.invoke(prompt);

                const industryRaw = industrymap.data.find(e => e.indexCode == industry[i].industryCode);

                await db
                    .insert(sectorInfo)
                    .values({
                        indName: industry[i].vietnameseName,
                        indCode: industry[i].industryCode,
                        indMarketCap: industryRaw.indMarketCap,
                        indIndex: industryRaw.indIndex,
                        indIndexChgPct: industryRaw.indIndexChgPct,
                        indQuantity: industryRaw.indQuantity,
                        indTradedValue: industryRaw.indTradedValue,
                        content: result.content.toString(),
                        creatAt: new Date().toISOString()
                    });
                console.log(`Analysis Sector, Waiting 61s`);
                await delay(61000);
            } catch (e) {
                console.error(e);
                console.log(`Retry analysis ${industry[i].vietnameseName}`)
                i -= 1;
            }
        }
    } catch (err) {
        console.error(err);
    }
};

export default SectorAnalysis;

// SectorAnalysis();